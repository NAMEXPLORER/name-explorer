<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cultural Name Analysis</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
--primary: #4a54e1;
--primary-dark: #3a44d1;
--secondary: #ff6b6b;
--accent: #2ecc71;
--dark: #1a1a2e;
--darker: #16213e;
--light: #f8f9fa;
--gradient: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
--card-bg: rgba(255, 255, 255, 0.08);
--card-border: rgba(255, 255, 255, 0.12);
}

* {
margin: 0;
padding: 0;
box-sizing: border-box;
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
background: var(--gradient);
color: var(--light);
min-height: 100vh;
overflow-x: hidden;
line-height: 1.6;
}

.container {
max-width: 1400px;
margin: 0 auto;
padding: 20px;
}

header {
text-align: center;
padding: 40px 0 20px;
position: relative;
}

.logo {
font-size: 3rem;
font-weight: 800;
margin-bottom: 10px;
background: linear-gradient(45deg, #fff, #a8edea);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.subtitle {
font-size: 1.2rem;
opacity: 0.9;
max-width: 700px;
margin: 0 auto 30px;
font-weight: 300;
}

.search-header {
background: rgba(0, 0, 0, 0.3);
padding: 15px 25px;
border-radius: 15px;
margin-bottom: 20px;
text-align: center;
font-size: 1.1rem;
border: 1px solid rgba(255, 255, 255, 0.1);
}

.main-content {
display: flex;
justify-content: space-between;
gap: 40px;
margin: 40px 0;
align-items: flex-start;
}

.globe-section {
flex: 1;
display: flex;
justify-content: center;
align-items: center;
position: relative;
}

.globe-container {
width: 500px;
height: 500px;
border-radius: 50%;
overflow: hidden;
box-shadow:
0 15px 35px rgba(0, 0, 0, 0.5),
inset 0 0 50px rgba(255, 255, 255, 0.1);
position: relative;
background: rgba(0, 0, 0, 0.2);
transition: transform 0.3s ease;
}

.globe-container:hover {
transform: scale(1.02);
}

#globeCanvas {
width: 100%;
height: 100%;
display: block;
}

.globe-controls {
position: absolute;
bottom: 20px;
left: 50%;
transform: translateX(-50%);
background: rgba(0, 0, 0, 0.5);
padding: 10px 20px;
border-radius: 30px;
display: flex;
gap: 15px;
backdrop-filter: blur(10px);
z-index: 10;
}

.control-btn {
background: rgba(255, 255, 255, 0.2);
border: none;
color: white;
width: 40px;
height: 40px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
transition: all 0.3s ease;
}

.control-btn:hover {
background: rgba(255, 255, 255, 0.3);
transform: scale(1.1);
}

.search-section {
flex: 1;
background: var(--card-bg);
backdrop-filter: blur(15px);
border-radius: 20px;
padding: 35px;
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
border: 1px solid var(--card-border);
min-height: 500px;
display: flex;
flex-direction: column;
}

.search-title {
font-size: 1.8rem;
margin-bottom: 25px;
text-align: center;
font-weight: 600;
}

.checkbox-container {
display: flex;
align-items: center;
margin-bottom: 25px;
padding: 15px;
background: rgba(0, 0, 0, 0.2);
border-radius: 10px;
}

.checkbox-container input {
margin-right: 12px;
transform: scale(1.3);
accent-color: var(--primary);
}

.checkbox-container label {
font-weight: 500;
}

.name-inputs-container {
display: flex;
flex-direction: column;
gap: 15px;
margin-bottom: 20px;
}

.name-input-group {
display: flex;
flex-direction: column;
gap: 8px;
}

.name-input-group label {
font-weight: 600;
font-size: 1rem;
}

input[type="text"] {
padding: 18px 25px;
border: none;
border-radius: 50px;
background: rgba(255, 255, 255, 0.95);
font-size: 1.1rem;
box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.1);
transition: all 0.3s ease;
color: #333;
width: 100%;
}

input[type="text"]:focus {
outline: none;
box-shadow:
inset 0 2px 10px rgba(0, 0, 0, 0.1),
0 0 0 3px rgba(74, 84, 225, 0.3);
transform: translateY(-2px);
}

.search-btn {
background: var(--primary);
color: white;
border: none;
border-radius: 50px;
padding: 18px 35px;
font-size: 1.1rem;
font-weight: 600;
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
gap: 10px;
transition: all 0.3s ease;
box-shadow: 0 5px 15px rgba(74, 84, 225, 0.4);
min-width: 180px;
width: 100%;
margin-top: 10px;
}

.search-btn:hover {
background: var(--primary-dark);
transform: translateY(-3px);
box-shadow: 0 8px 20px rgba(74, 84, 225, 0.6);
}

.search-btn:active {
transform: translateY(0);
}

.search-btn.loading {
pointer-events: none;
opacity: 0.7;
}

.search-btn.loading::after {
content: '';
width: 16px;
height: 16px;
border: 2px solid transparent;
border-top: 2px solid white;
border-radius: 50%;
animation: spin 1s linear infinite;
}

@keyframes spin {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}

.suggestions {
display: flex;
flex-wrap: wrap;
gap: 10px;
margin-top: 20px;
justify-content: center;
}

.suggestion-tag {
background: rgba(255, 255, 255, 0.15);
color: white;
padding: 8px 16px;
border-radius: 20px;
font-size: 0.9rem;
cursor: pointer;
transition: all 0.3s ease;
}

.suggestion-tag:hover {
background: rgba(255, 255, 255, 0.25);
transform: translateY(-2px);
}

.loading-spinner {
display: none;
text-align: center;
margin: 20px 0;
}

.spinner {
width: 40px;
height: 40px;
border: 4px solid rgba(255, 255, 255, 0.3);
border-top: 4px solid white;
border-radius: 50%;
animation: spin 1s linear infinite;
margin: 0 auto;
}

.analysis-result {
margin-top: 25px;
padding: 20px;
background: rgba(0, 0, 0, 0.3);
border-radius: 15px;
display: none;
animation: fadeIn 0.5s ease;
flex-grow: 1;
overflow-y: auto;
}

@keyframes fadeIn {
from { opacity: 0; transform: translateY(10px); }
to { opacity: 1; transform: translateY(0); }
}

.result-title {
font-size: 1.4rem;
margin-bottom: 10px;
color: #ffd700;
}

.result-message {
font-size: 1.1rem;
line-height: 1.6;
text-align: left;
}

.name-highlight {
color: #ffd700;
font-weight: bold;
font-size: 1.2em;
}

.analysis-details {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 20px;
margin-top: 20px;
}

.analysis-section {
background: rgba(255, 255, 255, 0.1);
border-radius: 10px;
padding: 15px;
}

.analysis-section h4 {
margin-bottom: 10px;
color: #ffd700;
border-bottom: 1px solid rgba(255, 255, 255, 0.2);
padding-bottom: 5px;
}

.distribution-chart {
margin-top: 20px;
background: rgba(255, 255, 255, 0.1);
border-radius: 10px;
padding: 15px;
}

.country-list {
display: flex;
flex-wrap: wrap;
gap: 10px;
margin-top: 10px;
}

.country-tag {
background: rgba(255, 255, 255, 0.2);
padding: 5px 10px;
border-radius: 15px;
font-size: 0.9rem;
}

.name-variants {
margin-top: 15px;
}

.variant {
display: inline-block;
background: rgba(255, 255, 255, 0.15);
padding: 5px 10px;
margin: 5px;
border-radius: 5px;
font-style: italic;
}

.pronunciation {
margin-top: 15px;
font-size: 1.2rem;
color: #a8edea;
font-weight: bold;
display: flex;
align-items: center;
gap: 10px;
flex-wrap: wrap;
}

.audio-btn {
background: var(--primary);
color: white;
border: none;
border-radius: 50%;
width: 40px;
height: 40px;
display: inline-flex;
align-items: center;
justify-content: center;
cursor: pointer;
transition: all 0.3s ease;
}

.audio-btn:hover {
background: var(--primary-dark);
transform: scale(1.1);
}

.audio-btn.playing {
background: var(--accent);
animation: pulse 1s infinite;
}

@keyframes pulse {
0% { transform: scale(1); }
50% { transform: scale(1.1); }
100% { transform: scale(1); }
}

.external-links {
display: flex;
gap: 10px;
margin-top: 10px;
flex-wrap: wrap;
}

.external-link {
background: rgba(255, 255, 255, 0.15);
color: white;
text-decoration: none;
padding: 5px 10px;
border-radius: 15px;
font-size: 0.9rem;
transition: all 0.3s ease;
display: flex;
align-items: center;
gap: 5px;
}

.external-link:hover {
background: rgba(255, 255, 255, 0.25);
transform: translateY(-2px);
}

.audio-loading {
display: none;
font-size: 0.9rem;
color: #a8edea;
margin-left: 10px;
}

.features {
display: flex;
justify-content: space-between;
margin: 80px 0 40px;
gap: 25px;
}

.feature-card {
flex: 1;
border-radius: 20px;
padding: 35px 30px;
text-align: center;
box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
transition: all 0.4s ease;
position: relative;
overflow: hidden;
z-index: 1;
}

.feature-card::before {
content: '';
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: linear-gradient(45deg, rgba(255,255,255,0.1), transparent);
z-index: -1;
opacity: 0;
transition: opacity 0.4s ease;
}

.feature-card:hover {
transform: translateY(-10px);
}

.feature-card:hover::before {
opacity: 1;
}

.feature-icon {
font-size: 3rem;
margin-bottom: 20px;
display: block;
}

.feature-card h3 {
font-size: 1.5rem;
margin-bottom: 15px;
font-weight: 700;
}

.feature-card p {
opacity: 0.9;
line-height: 1.6;
font-size: 1.05rem;
}

.feature-1 {
background: linear-gradient(135deg, #3498db, #8e44ad);
}

.feature-2 {
background: linear-gradient(135deg, #e74c3c, #e67e22);
}

.feature-3 {
background: linear-gradient(135deg, #2ecc71, #1abc9c);
}

.instructions {
text-align: center;
margin: 30px 0;
font-size: 1.1rem;
opacity: 0.9;
font-style: italic;
}

footer {
text-align: center;
margin-top: 60px;
padding: 30px;
opacity: 0.8;
font-size: 0.95rem;
border-top: 1px solid rgba(255, 255, 255, 0.1);
}

/* Warning Modal */
.warning-modal {
display: none;
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0.7);
z-index: 2000;
backdrop-filter: blur(5px);
}

.warning-content {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
background: var(--darker);
padding: 30px;
border-radius: 15px;
max-width: 500px;
width: 90%;
text-align: center;
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
}

.warning-icon {
font-size: 3rem;
color: var(--secondary);
margin-bottom: 20px;
}

.warning-btn {
background: var(--primary);
color: white;
border: none;
padding: 12px 25px;
border-radius: 50px;
font-size: 1rem;
font-weight: 600;
cursor: pointer;
margin-top: 20px;
transition: all 0.3s ease;
}

.warning-btn:hover {
background: var(--primary-dark);
transform: translateY(-2px);
}

@media (max-width: 1200px) {
.main-content {
flex-direction: column;
}

.globe-section, .search-section {
width: 100%;
}

.globe-container {
width: 450px;
height: 450px;
}

.analysis-details {
grid-template-columns: 1fr;
}

.features {
flex-direction: column;
}
}

@media (max-width: 768px) {
.globe-container {
width: 350px;
height: 350px;
}

h1 {
font-size: 2rem;
}

.logo {
font-size: 2.2rem;
}
}

@media (max-width: 480px) {
.globe-container {
width: 280px;
height: 280px;
}

.name-inputs-container {
flex-direction: column;
}

.search-btn {
width: 100%;
}

.search-section {
padding: 25px;
}
}
</style>
</head>
<body>
<div class="container">
<header>
<h1 class="logo">Cultural Name Analysis</h1>
<p class="subtitle">Explore the cultural roots, geographical distribution, and historical significance of names from around the world</p>
</header>

<div class="search-header">
<i class="fas fa-search"></i> Explore names pronunciation and cultural origins...
</div>

<div class="main-content">
<!-- Globe Section -->
<div class="globe-section">
<div class="globe-container">
<canvas id="globeCanvas"></canvas>
<div class="globe-controls">
<button class="control-btn" id="zoomIn"><i class="fas fa-plus"></i></button>
<button class="control-btn" id="zoomOut"><i class="fas fa-minus"></i></button>
<button class="control-btn" id="resetView"><i class="fas fa-sync-alt"></i></button>
</div>
</div>
</div>

<!-- Search & Results Section -->
<div class="search-section">
<h2 class="search-title">Explore Name Origins</h2>

<div class="checkbox-container">
<input type="checkbox" id="privacyCheck" checked>
<label for="privacyCheck">I understand this tool processes name data for cultural analysis</label>
</div>

<div class="name-inputs-container">
<div class="name-input-group">
<label for="firstNameInput">First Name</label>
<input type="text" id="firstNameInput" placeholder="Enter a first name...">
</div>

<div class="name-input-group">
<label for="lastNameInput">Last Name</label>
<input type="text" id="lastNameInput" placeholder="Enter a last name...">
</div>
</div>

<button class="search-btn" id="analyzeBtn">
<span>Analyze Name</span>
</button>

<div class="suggestions">
<div class="suggestion-tag" data-firstname="kevin">Kevin</div>
<div class="suggestion-tag" data-firstname="laurent">Laurent</div>
<div class="suggestion-tag" data-firstname="maria">Maria</div>
<div class="suggestion-tag" data-firstname="mohammed">Mohammed</div>
<div class="suggestion-tag" data-firstname="sofia">Sofia</div>
<div class="suggestion-tag" data-lastname="smith">Smith</div>
<div class="suggestion-tag" data-lastname="garcia">Garcia</div>
<div class="suggestion-tag" data-lastname="muller">M√ºller</div>
</div>

<div class="loading-spinner" id="loadingSpinner">
<div class="spinner"></div>
<p>Analyzing name...</p>
</div>

<div class="analysis-result" id="analysisResult">
<h3 class="result-title" id="resultTitle">Cultural Analysis</h3>
<div class="result-message" id="resultMessage">
<!-- Result content will be inserted here -->
</div>
</div>

<p class="instructions">Try first names like "Kevin", "Laurent", "Maria" or last names like "Smith", "Garcia", "M√ºller"</p>
</div>
</div>

<div class="features">
<div class="feature-card feature-1">
<div class="feature-icon">üåç</div>
<h3>Global Database</h3>
<p>Access our comprehensive database of over 50,000 names from 200+ cultures and regions. Our continuously updated collection ensures accurate cultural and historical context for every name.</p>
</div>

<div class="feature-card feature-2">
<div class="feature-icon">üìä</div>
<h3>Visual Analytics</h3>
<p>Explore interactive visualizations that reveal name distribution patterns, migration paths, and cultural connections through beautiful, intuitive data representations.</p>
</div>

<div class="feature-card feature-3">
<div class="feature-icon">üîí</div>
<h3>Privacy First</h3>
<p>Your data stays with you. We employ advanced privacy measures and never store personal information. All analysis happens securely in your browser.</p>
</div>
</div>

<footer>
<p>¬© 2024 Cultural Name Analysis Tool | Exploring Global Names and Cultural Heritage</p>
</footer>
</div>

<!-- Warning Modal -->
<div class="warning-modal" id="warningModal">
<div class="warning-content">
<div class="warning-icon">
<i class="fas fa-exclamation-triangle"></i>
</div>
<h2>Search Error</h2>
<p>You can only search for a first name <strong>OR</strong> a last name, not both at the same time.</p>
<p>Please clear one of the fields and try again.</p>
<button class="warning-btn" id="warningCloseBtn">OK, I Understand</button>
</div>
</div>

<script>
// Enhanced Name Database with first and last names
const nameDatabase = {
// First names
"kevin": {
type: "first",
origins: ["Irish", "English", "French"],
meaning: "Handsome, beautiful birth",
pronunciation: "KEV-in",
history: "Kevin is an anglicized form of the Irish name Caoimh√≠n, which means 'handsome birth' or 'born of nobility'. The name was popularized by Saint Kevin, a 6th-century Irish saint who founded the Glendalough monastery. It became widely used in English-speaking countries in the mid-20th century.",
distribution: {
"United States": 32.5,
"Ireland": 28.7,
"United Kingdom": 25.4,
"Canada": 22.1,
"Australia": 18.9,
"France": 15.6,
"Germany": 12.3,
"New Zealand": 10.8
},
variants: ["K√©vin", "Kevan", "Kevyn", "Caoimh√≠n"],
culturalSignificance: "In Ireland, Kevin remains a popular traditional name. In the United States, it peaked in popularity during the 1970s and 1980s. The name has been used in various cultural references, including the character Kevin McCallister from the 'Home Alone' film series."
},
"laurent": {
type: "first",
origins: ["French", "Latin"],
meaning: "From Laurentum, crowned with laurel",
pronunciation: "lor-AHN",
history: "Laurent is the French form of the Roman name Laurentius, which means 'from Laurentum'. Laurentum was an ancient Roman city. The name was borne by several early saints, most notably Saint Lawrence, a 3rd-century deacon and martyr. It has been a traditional French name for centuries.",
distribution: {
"France": 45.3,
"Canada": 28.7,
"Belgium": 22.4,
"Switzerland": 18.9,
"United States": 12.6,
"United Kingdom": 8.7,
"Germany": 6.4,
"Italy": 5.2
},
variants: ["Lorenzo", "Lawrence", "Laurence", "Lars", "Loren"],
culturalSignificance: "In French culture, Laurent is a classic name that has maintained steady popularity. It's associated with sophistication and tradition. The name appears in French literature and is borne by several notable French figures, including fashion designer Laurent Dombrowicz."
},
"maria": {
type: "first",
origins: ["Latin", "Hebrew"],
meaning: "Bitter or beloved",
pronunciation: "mah-REE-ah",
history: "Maria is the Latin form of the Hebrew name Miriam, which was the name of Moses' sister in the Old Testament. The name gained popularity through the Virgin Mary, mother of Jesus, in Christian tradition. It has been one of the most popular names in the Western world for centuries.",
distribution: {
"Italy": 18.5,
"Spain": 15.2,
"Portugal": 12.8,
"Brazil": 11.3,
"Mexico": 9.7,
"Philippines": 8.4,
"Poland": 7.1,
"Germany": 6.5,
"United States": 5.9,
"France": 4.6
},
variants: ["Mary", "Marie", "Mariya", "M√°ria", "Mariam"],
culturalSignificance: "In Hispanic cultures, Maria is often combined with other names (e.g., Maria Jos√©, Ana Maria). In Orthodox Christian traditions, the name is highly revered. In many European countries, it was traditionally given to honor the Virgin Mary."
},
"mohammed": {
type: "first",
origins: ["Arabic"],
meaning: "Praised, praiseworthy",
pronunciation: "moh-HAH-med",
history: "Muhammad is the name of the Islamic prophet, founder of Islam. The name has been extremely popular in Muslim communities worldwide since the 7th century. It is often considered the most common given name in the world.",
distribution: {
"Egypt": 22.1,
"Pakistan": 18.7,
"Bangladesh": 15.3,
"Indonesia": 12.9,
"Nigeria": 10.5,
"Turkey": 8.2,
"Iran": 7.4,
"Saudi Arabia": 6.8,
"Morocco": 5.9,
"Algeria": 4.2
},
variants: ["Muhammad", "Mehmet", "Mohamed", "Mahomet", "Mahmud"],
culturalSignificance: "The name is considered holy in Islam, and many Muslims name their sons Muhammad to honor the prophet. It's often combined with other names (e.g., Muhammad Ali). In some cultures, the name is believed to bring blessings."
},
"sofia": {
type: "first",
origins: ["Greek"],
meaning: "Wisdom",
pronunciation: "so-FEE-ah",
history: "Sofia is derived from the Greek word 'sophia' meaning wisdom. The name was borne by an early Christian martyr, Saint Sophia. It became popular in Eastern Orthodox countries and later spread throughout Europe.",
distribution: {
"Italy": 16.8,
"Russia": 14.5,
"Brazil": 12.3,
"Mexico": 10.7,
"Spain": 9.4,
"United States": 8.1,
"Poland": 7.2,
"Ukraine": 6.5,
"Argentina": 5.3,
"Germany": 4.2
},
variants: ["Sophia", "Sofiya", "Zofia", "Sofie", "Sonia"],
culturalSignificance: "In Orthodox tradition, Saint Sophia is venerated as a martyr. The name represents the divine wisdom in Christian theology. In recent years, it has become fashionable in many Western countries."
},

// Last names
"smith": {
type: "last",
origins: ["English"],
meaning: "Metal worker, blacksmith",
pronunciation: "smith",
history: "Smith is an English occupational name for a metalworker, derived from the Old English 'smi√∞'. It is one of the most common surnames in the English-speaking world.",
distribution: {
"United States": 1.0,
"United Kingdom": 1.2,
"Australia": 1.5,
"Canada": 1.1,
"New Zealand": 1.3,
"Ireland": 0.8
},
variants: ["Smyth", "Smythe"],
culturalSignificance: "As one of the most common English surnames, Smith represents the importance of metalworking in medieval society. Blacksmiths were essential community members who created tools, weapons, and household items."
},
"garcia": {
type: "last",
origins: ["Spanish", "Portuguese"],
meaning: "Bear, brave warrior",
pronunciation: "gar-SEE-ah",
history: "Garcia is a patronymic surname of Basque origin, meaning 'bear'. It became widespread throughout the Iberian Peninsula and is now one of the most common surnames in the Spanish-speaking world.",
distribution: {
"Spain": 3.5,
"Mexico": 4.1,
"United States": 1.8,
"Argentina": 2.2,
"Colombia": 2.7,
"Peru": 2.4,
"Venezuela": 2.1,
"Philippines": 1.3
},
variants: ["Garc√≠a", "Garsia"],
culturalSignificance: "Garcia is one of the most common Hispanic surnames, reflecting the influence of Basque culture in Spain. It has been borne by numerous notable figures in Spanish and Latin American history."
},
"muller": {
type: "last",
origins: ["German"],
meaning: "Miller",
pronunciation: "MULL-er",
history: "M√ºller is a German occupational surname for a miller, derived from the Middle High German 'm√ºln√¶re'. It is the most common surname in Germany and Switzerland.",
distribution: {
"Germany": 0.9,
"Switzerland": 1.1,
"Austria": 0.8,
"United States": 0.3,
"France": 0.2,
"Brazil": 0.2
},
variants: ["Mueller", "M√ºller", "Miller"],
culturalSignificance: "As the most common German surname, M√ºller reflects the importance of milling in medieval European society. Millers were essential for processing grain into flour, a staple food."
}
};

// DOM Elements
const analysisResult = document.getElementById('analysisResult');
const resultTitle = document.getElementById('resultTitle');
const resultMessage = document.getElementById('resultMessage');
const firstNameInput = document.getElementById('firstNameInput');
const lastNameInput = document.getElementById('lastNameInput');
const analyzeBtn = document.getElementById('analyzeBtn');
const privacyCheck = document.getElementById('privacyCheck');
const loadingSpinner = document.getElementById('loadingSpinner');
const zoomInBtn = document.getElementById('zoomIn');
const zoomOutBtn = document.getElementById('zoomOut');
const resetViewBtn = document.getElementById('resetView');
const warningModal = document.getElementById('warningModal');
const warningCloseBtn = document.getElementById('warningCloseBtn');

// Three.js variables
let scene, camera, renderer, globe;

// Initialize the application
function init() {
initGlobe();
setupEventListeners();

// Auto-search for Kevin on page load to demonstrate functionality
setTimeout(() => {
firstNameInput.value = "Kevin";
analyzeName();
}, 1000);
}

// Initialize Three.js Globe with Google Earth-like appearance
function initGlobe() {
// Scene setup
scene = new THREE.Scene();
scene.background = null;

// Camera setup
const canvas = document.getElementById('globeCanvas');
camera = new THREE.PerspectiveCamera(45, canvas.clientWidth / canvas.clientHeight, 0.1, 2000);
camera.position.z = 300;

// Renderer setup
renderer = new THREE.WebGLRenderer({
canvas: canvas,
antialias: true,
alpha: true
});
renderer.setSize(canvas.clientWidth, canvas.clientHeight);
renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

// Create realistic Earth globe with texture
const globeGeometry = new THREE.SphereGeometry(100, 128, 128);

// Create a more realistic Earth material
const globeMaterial = new THREE.MeshPhongMaterial({
color: 0x2980b9, // Ocean blue
specular: 0x555555,
shininess: 30,
transparent: true,
opacity: 0.95
});

globe = new THREE.Mesh(globeGeometry, globeMaterial);
scene.add(globe);

// Add continent-like features
addContinentFeatures();

// Add cloud layer
const cloudGeometry = new THREE.SphereGeometry(101, 128, 128);
const cloudMaterial = new THREE.MeshPhongMaterial({
color: 0xffffff,
transparent: true,
opacity: 0.2
});

const clouds = new THREE.Mesh(cloudGeometry, cloudMaterial);
scene.add(clouds);

// Add atmospheric glow
const atmosphereGeometry = new THREE.SphereGeometry(110, 64, 64);
const atmosphereMaterial = new THREE.MeshBasicMaterial({
color: 0x4488ff,
transparent: true,
opacity: 0.08,
side: THREE.BackSide
});

const atmosphere = new THREE.Mesh(atmosphereGeometry, atmosphereMaterial);
scene.add(atmosphere);

// Add enhanced lighting for realism
const ambientLight = new THREE.AmbientLight(0x333333, 0.4);
scene.add(ambientLight);

const directionalLight = new THREE.DirectionalLight(0xffffff, 1.2);
directionalLight.position.set(5, 3, 5);
scene.add(directionalLight);

const pointLight = new THREE.PointLight(0x4488ff, 0.5, 500);
pointLight.position.set(10, 10, 10);
scene.add(pointLight);

// Add stars background
addStars();

// Animation
function animate() {
requestAnimationFrame(animate);

// Enhanced rotation with multiple layers
globe.rotation.y += 0.0005;
clouds.rotation.y += 0.0007;

renderer.render(scene, camera);
}

animate();

// Handle window resize
window.addEventListener('resize', onWindowResize);

// Add globe interaction
setupGlobeInteractions();
}

// Add continent-like features to the globe
function addContinentFeatures() {
const continentPositions = [
{ lat: 40, lon: -100, size: 25, color: 0x27ae60 }, // North America
{ lat: 0, lon: -60, size: 30, color: 0x2ecc71 }, // South America
{ lat: 50, lon: 10, size: 20, color: 0x3498db }, // Europe
{ lat: 20, lon: 100, size: 35, color: 0xe74c3c }, // Asia
{ lat: -25, lon: 135, size: 28, color: 0xf39c12 }, // Australia
{ lat: -10, lon: 20, size: 32, color: 0xd35400 } // Africa
];

continentPositions.forEach(continent => {
const phi = (90 - continent.lat) * (Math.PI / 180);
const theta = (continent.lon + 180) * (Math.PI / 180);

const radius = 100.5;
const x = -(radius * Math.sin(phi) * Math.cos(theta));
const y = radius * Math.cos(phi);
const z = radius * Math.sin(phi) * Math.sin(theta);

const continentGeometry = new THREE.SphereGeometry(continent.size, 16, 16);
const continentMaterial = new THREE.MeshBasicMaterial({
color: continent.color,
transparent: true,
opacity: 0.7
});

const continentMesh = new THREE.Mesh(continentGeometry, continentMaterial);
continentMesh.position.set(x, y, z);

scene.add(continentMesh);
});
}

// Add stars to the scene
function addStars() {
const starGeometry = new THREE.BufferGeometry();
const starCount = 5000;
const positions = new Float32Array(starCount * 3);

for (let i = 0; i < starCount * 3; i += 3) {
const radius = 500 + Math.random() * 700;
const theta = Math.random() * Math.PI * 2;
const phi = Math.acos((Math.random() * 2) - 1);

positions[i] = radius * Math.sin(phi) * Math.cos(theta);
positions[i+1] = radius * Math.sin(phi) * Math.sin(theta);
positions[i+2] = radius * Math.cos(phi);
}

starGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));

const starMaterial = new THREE.PointsMaterial({
size: 1.5,
color: 0xffffff,
transparent: true,
sizeAttenuation: true
});

const stars = new THREE.Points(starGeometry, starMaterial);
scene.add(stars);
}

// Handle window resize
function onWindowResize() {
const container = document.querySelector('.globe-container');
const canvas = document.getElementById('globeCanvas');

camera.aspect = container.clientWidth / container.clientHeight;
camera.updateProjectionMatrix();
renderer.setSize(container.clientWidth, container.clientHeight);
}

// Setup globe interactions
function setupGlobeInteractions() {
const globeContainer = document.querySelector('.globe-container');
let isMouseDown = false;
let previousMousePosition = { x: 0, y: 0 };

globeContainer.addEventListener('mousedown', (e) => {
isMouseDown = true;
previousMousePosition = { x: e.clientX, y: e.clientY };
globeContainer.style.cursor = 'grabbing';
});

window.addEventListener('mouseup', () => {
isMouseDown = false;
globeContainer.style.cursor = 'grab';
});

globeContainer.addEventListener('mousemove', (e) => {
if (!isMouseDown) return;

const deltaX = e.clientX - previousMousePosition.x;
const deltaY = e.clientY - previousMousePosition.y;

globe.rotation.y += deltaX * 0.01;
globe.rotation.x += deltaY * 0.01;

previousMousePosition = { x: e.clientX, y: e.clientY };
});

// Zoom functionality
globeContainer.addEventListener('wheel', (e) => {
e.preventDefault();

if (e.deltaY < 0) {
// Zoom in
camera.position.z = Math.max(150, camera.position.z - 15);
} else {
// Zoom out
camera.position.z = Math.min(800, camera.position.z + 15);
}
});

// Set initial cursor
globeContainer.style.cursor = 'grab';
}

// Setup event listeners
function setupEventListeners() {
// Search button functionality
analyzeBtn.addEventListener('click', analyzeName);

// Enter key functionality
firstNameInput.addEventListener('keypress', (e) => {
if (e.key === 'Enter') {
analyzeName();
}
});

lastNameInput.addEventListener('keypress', (e) => {
if (e.key === 'Enter') {
analyzeName();
}
});

// Globe controls
zoomInBtn.addEventListener('click', () => {
camera.position.z = Math.max(150, camera.position.z - 30);
});

zoomOutBtn.addEventListener('click', () => {
camera.position.z = Math.min(800, camera.position.z + 30);
});

resetViewBtn.addEventListener('click', () => {
camera.position.z = 300;
globe.rotation.x = 0;
globe.rotation.y = 0;
});

// Warning modal close button
warningCloseBtn.addEventListener('click', () => {
warningModal.style.display = 'none';
});

// Suggestion tags
document.querySelectorAll('.suggestion-tag').forEach(tag => {
tag.addEventListener('click', () => {
const firstName = tag.getAttribute('data-firstname');
const lastName = tag.getAttribute('data-lastname');

if (firstName) {
firstNameInput.value = firstName;
lastNameInput.value = '';
} else if (lastName) {
lastNameInput.value = lastName;
firstNameInput.value = '';
}

analyzeName();
});
});
}

// Analyze name function with validation
function analyzeName() {
if (!privacyCheck.checked) {
showResult('Please confirm that you understand this tool processes name data for cultural analysis.', false);
return;
}

const firstName = firstNameInput.value.trim().toLowerCase();
const lastName = lastNameInput.value.trim().toLowerCase();

// Validate that only one field is filled
if (firstName && lastName) {
showWarningModal();
return;
}

if (!firstName && !lastName) {
showResult('Please enter either a first name or a last name to analyze.', false);
return;
}

const name = firstName || lastName;
const nameType = firstName ? 'first' : 'last';

// Show loading state
analyzeBtn.classList.add('loading');
loadingSpinner.style.display = 'block';
analysisResult.style.display = 'none';

// Simulate API call with timeout
setTimeout(() => {
// Check if name is in database and matches the correct type
if (nameDatabase[name] && nameDatabase[name].type === nameType) {
displayNameAnalysis(name, nameDatabase[name]);
} else {
showResult(`We don't have detailed analysis for "${name}" in our ${nameType} name database yet. Try one of the example names.`, false);
}

// Hide loading state
analyzeBtn.classList.remove('loading');
loadingSpinner.style.display = 'none';
}, 1000);
}

// Show warning modal when both fields are filled
function showWarningModal() {
warningModal.style.display = 'block';
}

// Display detailed name analysis
function displayNameAnalysis(name, data) {
const nameCapitalized = name.charAt(0).toUpperCase() + name.slice(1);
const nameType = data.type === 'first' ? 'First Name' : 'Last Name';
resultTitle.textContent = `Cultural Analysis: ${nameCapitalized} (${nameType})`;

let html = `
<div class="analysis-details">
<div class="analysis-section">
<h4>Origin & Meaning</h4>
<p><strong>Origin:</strong> ${data.origins.join(', ')}</p>
<p><strong>Meaning:</strong> ${data.meaning}</p>
<div class="pronunciation">
<strong>Pronunciation:</strong> ${data.pronunciation}
<button class="audio-btn" onclick="playPronunciation('${name}')" id="audioBtn-${name}">
<i class="fas fa-volume-up"></i>
</button>
</div>
</div>
<div class="analysis-section">
<h4>Name Variants</h4>
<div class="name-variants">
${data.variants.map(variant => `<span class="variant">${variant}</span>`).join('')}
</div>
</div>
</div>

<div class="external-links" style="margin-top: 20px;">
<h4>Learn More About This Name</h4>
<a href="https://www.behindthename.com/name/${name}" target="_blank" class="external-link">
<i class="fas fa-external-link-alt"></i> Behind the Name
</a>
<a href="https://forvo.com/word/${name}/" target="_blank" class="external-link">
<i class="fas fa-volume-up"></i> Forvo Pronunciation
</a>
<a href="https://www.nameshouts.com/name/${name}" target="_blank" class="external-link">
<i class="fas fa-language"></i> NameShouts
</a>
<a href="https://en.wikipedia.org/wiki/${nameCapitalized}_(name)" target="_blank" class="external-link">
<i class="fab fa-wikipedia-w"></i> Wikipedia
</a>
</div>

<div class="distribution-chart">
<h4>Geographical Distribution</h4>
<p>Percentage of population with this name by country:</p>
<div class="country-list">
${Object.keys(data.distribution).map(country =>
`<div class="country-tag">${country}: ${data.distribution[country]}%</div>`
).join('')}
</div>
</div>
`;

resultMessage.innerHTML = html;
analysisResult.style.display = 'block';

// Scroll to the result
analysisResult.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

// Show result function
function showResult(message, isSuccess) {
resultTitle.textContent = isSuccess ? 'Cultural Analysis' : 'Notice';
resultMessage.innerHTML = message;
analysisResult.style.display = 'block';

// Scroll to the result
analysisResult.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

// Play pronunciation audio - Improved with immediate response
function playPronunciation(name) {
const nameData = nameDatabase[name];
if (!nameData) return;

const audioBtn = document.getElementById(`audioBtn-${name}`);

// Show playing state immediately
audioBtn.classList.add('playing');

// Use Web Speech API
if ('speechSynthesis' in window) {
// Cancel any ongoing speech
speechSynthesis.cancel();

const utterance = new SpeechSynthesisUtterance(name);

// Try to set appropriate language based on name origin
if (nameData.origins.includes("French")) {
utterance.lang = 'fr-FR';
} else if (nameData.origins.includes("Spanish")) {
utterance.lang = 'es-ES';
} else if (nameData.origins.includes("German")) {
utterance.lang = 'de-DE';
} else if (nameData.origins.includes("Arabic")) {
utterance.lang = 'ar-SA';
} else {
utterance.lang = 'en-US';
}

utterance.rate = 0.8;
utterance.pitch = 1;

utterance.onend = function() {
audioBtn.classList.remove('playing');
};

utterance.onerror = function() {
audioBtn.classList.remove('playing');
alert(`Could not play pronunciation. Please use the external links for audio pronunciation.`);
};

speechSynthesis.speak(utterance);
} else {
// Fallback if Web Speech API is not available
audioBtn.classList.remove('playing');
alert(`Pronunciation: ${nameData.pronunciation}. Your browser doesn't support audio playback.`);
}
}

// Initialize the application when the page loads
window.addEventListener('load', init);
</script>
</body>
</html>
